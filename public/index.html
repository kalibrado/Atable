<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Planifiez vos repas de la semaine avec des rappels quotidiens">
    <meta name="theme-color" content="#069494">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Atable!">
    <title>Atable!</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512.png">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <link rel="stylesheet" href="src/css/main.css">
</head>

<body>
    <div class="container">
        <!-- En-t√™te de l'application -->
        <header>
            <div class="header">
                <div class="header-content">
                    <h1>Atable! <span id="name-user"></span></h1>
                    <p class="subtitle">Planifiez vos repas du lundi au dimanche</p>
                </div>
                <div class="header-actions">
                    <button id="settings-btn" class="settings-btn" onclick="window.location.reload()" title="Actualiser"
                        aria-label="Actualiser">
                        üîÑÔ∏è
                    </button>
                    <button id="settings-btn" class="settings-btn" onclick="openSettings()" title="Param√®tres"
                        aria-label="Param√®tres">
                        ‚öôÔ∏è
                    </button>
                    <button id="logout-btn" class="logout-btn" onclick="handleLogout()" title="D√©connexion"
                        aria-label="D√©connexion">
                        üö™
                    </button>
                </div>
            </div>
            <div id="weeks-tabs-container" class="weeks-tabs" style="display: none;">
            </div>
        </header>

        <!-- Modal de param√®tres -->
        <div id="settings-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚öôÔ∏è Param√®tres</h2>
                    <button class="close-btn" onclick="closeSettings()">&times;</button>
                </div>

                <div class="modal-body">
                    <!-- Section: Personnalisation -->
                    <div class="settings-section collapsed" data-section="customization">
                        <div class="settings-section-header">
                            <div class="settings-section-title">
                                <span class="emoji">üé®</span>
                                <span>Personnalisation</span>
                            </div>
                            <span class="section-toggle-icon">‚ñº</span>
                        </div>
                        <div class="settings-section-content">
                            <div class="settings-group">
                                <div class="setting-group">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="dark-mode">
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Mode sombre</span>
                                    </label>
                                    <p class="setting-description">
                                        Activez le th√®me sombre pour r√©duire la fatigue oculaire
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section: Planification -->
                    <div class="settings-section collapsed" data-section="planning">
                        <div class="settings-section-header">
                            <div class="settings-section-title">
                                <span class="emoji">üìÖ</span>
                                <span>Planification</span>
                            </div>
                            <span class="section-toggle-icon">‚ñº</span>
                        </div>
                        <div class="settings-section-content">
                            <div class="settings-group">
                                <div class="setting-group">
                                    <label for="number-of-weeks">
                                        <strong>Nombre de semaines</strong>
                                    </label>
                                    <select id="number-of-weeks" class="weeks-select">
                                        <option value="1">1 semaine</option>
                                        <option value="2">2 semaines</option>
                                        <option value="3">3 semaines</option>
                                        <option value="4">4 semaines</option>
                                    </select>
                                    <p class="setting-description">
                                        Planifiez vos repas sur plusieurs semaines. Les donn√©es seront conserv√©es.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section: G√©n√©ration automatique -->
                    <div class="settings-section collapsed" data-section="generator">
                        <div class="settings-section-header">
                            <div class="settings-section-title">
                                <span class="emoji">ü§ñ</span>
                                <span>G√©n√©ration automatique</span>
                                <span class="section-badge new">Nouveau</span>
                            </div>
                            <span class="section-toggle-icon">‚ñº</span>
                        </div>
                        <div class="settings-section-content">
                            <p class="setting-description">
                                G√©n√©rez automatiquement vos repas √† partir de vos pr√©f√©rences alimentaires.
                                Le syst√®me utilise une rotation intelligente pour varier les repas.
                            </p>
                            <div class="settings-group">
                                <div class="setting-group">
                                    <button class="btn-primary btn-generate"
                                        onclick="window.generatorHandlers.generateFillEmpty()">
                                        üé≤ Remplir les cases vides
                                    </button>
                                    <p class="setting-description">
                                        G√©n√®re des repas uniquement pour les jours o√π aucun repas n'est planifi√©
                                    </p>
                                </div>

                                <div class="setting-group">
                                    <button class="btn-danger btn-generate"
                                        onclick="window.generatorHandlers.generateReplaceAll()">
                                        üîÑ Tout remplacer
                                    </button>
                                    <p class="setting-description warning">
                                        ‚ö†Ô∏è Remplace TOUS vos repas par des repas g√©n√©r√©s automatiquement
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section: Pr√©f√©rences alimentaires -->
                    <div class="settings-section collapsed" data-section="ingredients">
                        <div class="settings-section-header">
                            <div class="settings-section-title">
                                <span class="emoji">üçΩÔ∏è</span>
                                <span>Pr√©f√©rences alimentaires</span>
                            </div>
                            <span class="section-toggle-icon">‚ñº</span>
                        </div>
                        <div class="settings-section-content">
                            <p class="setting-description">
                                D√©finissez vos cat√©gories d'ingr√©dients pr√©f√©r√©s et indiquez pour quels repas vous les
                                utilisez.
                            </p>
                            <div id="ingredients-container" class="ingredients-container">
                                <!-- Les cat√©gories d'ingr√©dients seront g√©n√©r√©es ici par JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Section: Notifications -->
                    <div class="settings-section collapsed" data-section="notifications">
                        <div class="settings-section-header">
                            <div class="settings-section-title">
                                <span class="emoji">üîî</span>
                                <span>Notifications</span>
                            </div>
                            <span class="section-toggle-icon">‚ñº</span>
                        </div>
                        <div class="settings-section-content">
                            <div class="settings-group">
                                <div class="setting-group">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="enable-notifications">
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Activer les notifications</span>
                                    </label>
                                    <p class="setting-description">
                                        Recevez un rappel quotidien avec vos repas
                                    </p>
                                </div>
                                <div class="setting-group" id="time-setting">
                                    <label for="notification-time">
                                        <strong>üïê Heure de notification</strong>
                                    </label>
                                    <input type="time" id="notification-time" class="time-input">
                                </div>
                                <div class="setting-group">
                                    <div id="permission-status" class="permission-status">
                                        <span id="permission-text"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section: Compte (Danger Zone) -->
                    <div class="settings-section collapsed danger-zone" data-section="account">
                        <div class="settings-section-header">
                            <div class="settings-section-title">
                                <span class="emoji">üë§</span>
                                <span>Compte</span>
                                <span class="section-badge">Danger</span>
                            </div>
                            <span class="section-toggle-icon">‚ñº</span>
                        </div>
                        <div class="settings-section-content">
                            <div class="settings-group">
                                <div class="setting-group">
                                    <button class="btn-primary" onclick="window.userManager.changePassword()">
                                        Changer le mot de passe
                                    </button>
                                </div>
                                <div class="setting-group">
                                    <button class="btn-primary" onclick="window.userManager.changeEmail()">
                                        Changer l'adresse email
                                    </button>
                                </div>
                                <div class="setting-group">
                                    <button class="btn-danger" onclick="window.userManager.deleteAccount()">
                                        üóëÔ∏è Supprimer mon compte
                                    </button>
                                    <p class="setting-description warning">
                                        Cette action est d√©finitive
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn-primary" onclick="closeSettings()">
                        Fermer
                    </button>
                </div>
            </div>
        </div>

        <!-- Message de statut -->
        <div id="status-message" class="status-message"></div>

        <!-- Conteneur des jours de la semaine -->
        <main id="days-container" class="days-container">
            <!-- Les cartes des jours seront g√©n√©r√©es dynamiquement par JavaScript -->
        </main>
    </div>

    <script src="src/js/notifications.js"></script>
    <script type="module" src="src/js/app.js"></script>
</body>

</html>